<app-checkout-steps></app-checkout-steps>

<section class="pago-container">
  <h2 class="pago-titulo">ðŸ’³ Confirmar pago</h2>

  <!-- Estado de respuesta -->
  <div *ngIf="error" class="pago-error">{{ error }}</div>
  <div *ngIf="mensaje" class="pago-success">{{ mensaje }}</div>

  <!-- MÃ©todo de pago -->
  <div class="pago-seccion">
    <label for="metodo" class="pago-label"><strong>MÃ©todo de pago:</strong></label>
    <select
      id="metodo"
      [(ngModel)]="paymentMethod"
      (change)="seleccionarMetodo(paymentMethod)"
      class="pago-select"
    >
      <option value="EFECTIVO">Efectivo</option>
      <option value="YAPE">Yape</option>
      <option value="TARJETA">Tarjeta</option>
    </select>
  </div>

  <!-- QR Yape -->
  <div *ngIf="mostrarQR" class="pago-seccion qr-yape">
    <h4>Escanea el cÃ³digo QR con Yape:</h4>
    <img src="assets/qrs/qr.jpg" alt="QR Yape" class="pago-qr" />
    <button class="pago-btn-secundario" (click)="activarSubida()">Escaneado</button>
  </div>

  <!-- Subir comprobante -->
  <div *ngIf="mostrarSubida" class="pago-seccion">
    <label class="pago-label">Sube tu comprobante (imagen):</label>
    <input type="file" (change)="onFileSelected($event)" />
  </div>

  <!-- Resumen del carrito -->
  <div *ngIf="items.length > 0" class="pago-seccion">
    <h3 class="pago-subtitulo">Resumen del carrito:</h3>
    <ul class="pago-lista">
      <li *ngFor="let item of items" class="pago-item">
        <p class="pago-nombre">{{ item.producto.name }}</p>
        <p>Cantidad: {{ item.cantidad }}</p>
        <p>Precio: S/ {{ item.producto.price | number: '1.2-2' }}</p>
        <p class="pago-subtotal">
          Subtotal: S/ {{ item.producto.price * item.cantidad | number: '1.2-2' }}
        </p>
      </li>
    </ul>

    <div class="pago-total">
      Total: <span class="pago-total-valor">S/ {{ total | number: '1.2-2' }}</span>
    </div>
  </div>

  <!-- Confirmar compra -->
  <div class="pago-boton">
    <button
      (click)="confirmarCompra()"
      [disabled]="loading"
      class="pago-btn"
    >
      {{ loading ? 'Procesando...' : 'Confirmar compra' }}
    </button>
  </div>
</section>
